# 手順書

svelteの初期環境構築の手順書

## svelte

スベルトとは

参考：https://qiita.com/kurata04/items/d39e004dc3c837bfc4a1

## 手順

### ディレクトリ作成

```bash
mkdir svelte_getting_started

cd svelte_getting_started
```

### dockerファイル作成

vscodeで作成する

```bash
code .
```
`Dockerfile`の作成

```Dockerfile:Dockerfile
FROM node:22-alpine
WORKDIR /usr/app
```

`docker-compose.yml`の作成

```yml:docker-compose.yml
version: '3'

services:
  app:
    build: ./
    volumes:
      - ./:/usr/app
    command: sh -c "npm install && npm run dev"
    ports:
      - "3000:3000"
```

### svelteアプリの作成

```bash
docker-compose run --rm app sh -c "npm create svelte@latest ."
```

```
create-svelte version 6.3.8

┌  Welcome to SvelteKit!
│
◆  Where should we create your project?
│    (hit Enter to use current directory)
└
```
Enter
```
 Directory not empty. Continue?
│  Yes
```
Yes

```
◆  Which Svelte app template?
│  ● SvelteKit demo app (A demo app showcasing some of the features of
SvelteKit - play a word guessing game that works without JavaScript!)
│  ○ Skeleton project
│  ○ Library project
└
```
SvelteKit demo app

```
 Add type checking with TypeScript?
│  ● Yes, using TypeScript syntax
│  ○ Yes, using JavaScript with JSDoc comments
│  ○ No
└
```
Yes, using TypeScript syntax

```
 Select additional options (use arrow keys/space bar)
│  ◻ Add ESLint for code linting
│  ◻ Add Prettier for code formatting
│  ◻ Add Playwright for browser testing
│  ◻ Add Vitest for unit testing
│  ◻ Try the Svelte 5 preview (unstable!)
```
お好みで

### ファイル権限の変更

```bash
sudo chown -R $USER:$USER .
```

### viteの設定変更(wsl用)

下記のように、serverオプションを追加、pulginsのコンマを忘れずに
```ts:vite.config.ts
import { sveltekit } from '@sveltejs/kit/vite';
import { defineConfig } from 'vite';

export default defineConfig({
	plugins: [sveltekit()],
	server: {
		hmr: {
			host: 'localhost',
		},
	},
});
```

参考:https://github.com/laravel/vite-plugin/pull/42

### ビルド

```bash
docker-compose up
```

### 補足

#### Devcontainerを利用

VSCode Devcontainerは便利です

`開発コンテナー構成ファイルを追加`を選択

`docker-compose.yml`からを選択

`.devcontainer`フォルダができる。
中に`devcontainer.json`や`docker-compose.yml`ができる
ルートディレクトリの`docker-compose.yml`を上書きしてる

dev-containerを開く（再度開く、コンテナを開く）

```bash
npm run dev
```

### svelteをさわってみる

`src/routes/new`ディレクトリを作成

`src/routes/new/+page.svelte`ファイルを作成

#### inputと表記を同期させる

下記を貼り付け

```ts:+page.svelte
<script>
	let inputValue = 'input your name';

	function handleSubmit() {
		console.log(inputValue);
	}
</script>


<div class="text-column">
	<h1>New page</h1>

	<h2>## Please input your name!</h2>
	<input type="text" bind:value={inputValue}/>
	<button on:click={handleSubmit}>送信</button>
	<p>Hello, {inputValue} san!</p>
</div>
```

`src/routes/Header.svelte`を編集
下記をリスト内に追加

```ts:src/routes/Header.svelte
			<li aria-current={$page.url.pathname.startsWith('/new') ? 'page' : undefined}>
				<a href="/new">new</a>
			</li>
```

#### 変数が同期される

下記を`src/routes/new/+page.svelte`のscript内に追記する

```js:src/routes/new/+page.svelte
	// countが変更されるとdoubledも変更される
	let count = 0;
	$: doubled = count * 2;
```

さらに、同ファイルのdev内に下記を追記

```ts:src/routes/new/+page.svelte
	<h2>## You can change number!</h2>
	<input type="number" name="inputCount" id="inputNum" bind:value={count} />
	<p>{count} × 2 = {doubled}</p>
```

#### html内のif文

下記を`src/routes/new/+page.svelte`のdiv内に追記する

```ts:src/routes/new/+page.svelte
	<h2>## if</h2>
	{#if count > 10}
		<p>{count} is greater than 10</p>
	{:else if 5 > count}
		<p>{count} is less than 5</p>
	{:else}
		<p>{count} is between 5 and 10</p>
	{/if}
```

#### html内のeach文

下記を`src/routes/new/+page.svelte`のscript内に追記する

```js:src/routes/new/+page.svelte
	let cats = [
		{ name: 'クロ', id: 1 },
		{ name: 'シロ', id: 2 },
		{ name: 'ミケ', id: 3 },
		{ name: 'トラ', id: 4 },
		{ name: 'ハチワレ', id: 5 }
	];
```

さらに、同ファイルのdev内に下記を追記

```ts:src/routes/new/+page.svelte
	<h2>## each</h2>
	<ul>
		<li>
			<p>猫の名前</p>
			<ul>
				{#each cats as cat, i}
					<li>
						<p>
							{i + 1}: {cat.name}
						</p>
					</li>
				{/each}
			</ul>
		</li>
	</ul>
```

